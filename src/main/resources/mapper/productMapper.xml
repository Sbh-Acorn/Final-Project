<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="product">
    <!-- 안전모두 온&오프 -->
    <update id="setSafeUpdateOff">
        SET SQL_SAFE_UPDATES = 0;
    </update>

    <update id="setSafeUpdateOn">
        SET SQL_SAFE_UPDATES = 1;
    </update>
    <!--     모든 상품의 삭제 여부를 true로  -->
    <update id="setDeletedTrue">
        UPDATE Product SET is_deleted = true;
    </update>

    <!--   모든 상품의 FTA 여부를 false로 -->
    <update id="setFTAFalse">
        UPDATE Product SET is_deleted = false;
    </update>

    <!-- 동일한 id 존재 여부 -->

    <select id="checkId" resultType="int" parameterType="string">
        SELECT COUNT(1)
        FROM Product
        WHERE product_id  = #{product_id};
    </select>

    <!--  동일한 이름이 테이블에 존재하면 삭제여부를 false로  -->
    <update id="setDeletedFalse" parameterType="string">
        UPDATE Product SET is_deleted = false WHERE product_id = #{product_id};
    </update>

    <!--    브랜드아이디 찾기-->
        <select id="brandId" parameterType="string" resultType="int">
            SELECT brand_id
            FROM Brand
            WHERE name = #{brand};
        </select>

    <!--    카테고리 1 찾기-->
        <select id="category1Id" parameterType="string" resultType="int">
            SELECT category1_id
            FROM Category1
            WHERE name = #{category1};
        </select>
    <!--    카테고리 2 찾기-->
         <select id="category2Id" parameterType="string" resultType="int">
            SELECT category2_id
            FROM Category2
            WHERE name = #{category2};
        </select>
    <!--    카테고리 3 찾기-->
         <select id="category3Id" parameterType="string" resultType="int">
            SELECT category3_id
            FROM Category3
            WHERE name = #{category3};
        </select>


    <insert id="insert" parameterType="java.util.Map">
        INSERT INTO Product (product_id, brand_id, image_url, name,original_price,current_price,description,
                            category1_id,category2_id,category3_id,is_excludedVoucher)
        VALUES (#{product_id}, #{brand_id}, #{image_url}, #{name},#{original_price},#{current_price},#{description},
        #{category1_id},#{category2_id},#{category3_id},#{is_excludedVoucher});
    </insert>

<!--    fta 여부-->
    <update id="setFTA" parameterType="String">
        UPDATE Product SET is_fta = true WHERE product_id = #{product_id};
    </update>

</mapper>